

#include "arm_2d_helper.h"

#if defined(__clang__)
#   pragma clang diagnostic push
#   pragma clang diagnostic ignored "-Wunknown-warning-option"
#   pragma clang diagnostic ignored "-Wreserved-identifier"
#   pragma clang diagnostic ignored "-Wmissing-variable-declarations"
#   pragma clang diagnostic ignored "-Wcast-qual"
#   pragma clang diagnostic ignored "-Wmissing-declarations"
#   pragma clang diagnostic ignored "-Wgnu-variable-sized-type-not-at-end"
#   pragma clang diagnostic ignored "-Wimplicit-int-conversion"
#   pragma clang diagnostic ignored "-Wdeclaration-after-statement"
#   pragma clang diagnostic ignored "-Wgnu-zero-variadic-macro-arguments"
#   pragma clang diagnostic ignored "-Wincompatible-pointer-types-discards-qualifiers"
#   pragma clang diagnostic ignored "-Wpadded"
#   pragma clang diagnostic ignored "-Wunused-parameter"
#   pragma clang diagnostic ignored "-Wunused-variable"
#   pragma clang diagnostic ignored "-Wsign-conversion"
#elif defined(__IS_COMPILER_GCC__)
#   pragma GCC diagnostic ignored "-Wdiscarded-qualifiers"
#   pragma GCC diagnostic ignored "-Wunused-variable"
#elif defined(__IS_COMPILER_ARM_COMPILER_5__)
#   pragma diag_suppress=1296
#endif

typedef struct {
    uint16_t      hwIndex;
    arm_2d_size_t tCharSize;
    int16_t       iAdvance;
    int16_t       iBearingX;
    int16_t       iBearingY;
    uint8_t       chCodeLength;
    uint8_t       chUTF8[4];
} __ttf_char_descriptor_t;

ARM_SECTION("arm2d.asset.FONT")
const uint8_t c_bmpUTF8simsun_16A8Font[] = {


    // Glyph for character {0x2d}
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,

    // Glyph for character {0x30}
    0x00, 0x54, 0xe4, 0xe8, 0x5b, 0x00, 0x00,
    0x23, 0xe6, 0x31, 0x22, 0xda, 0x2b, 0x00,
    0x84, 0x7f, 0x00, 0x00, 0x6e, 0x97, 0x00,
    0xce, 0x33, 0x00, 0x00, 0x2d, 0xd5, 0x00,
    0xe9, 0x13, 0x00, 0x00, 0x11, 0xf3, 0x00,
    0xfc, 0x04, 0x00, 0x00, 0x04, 0xfc, 0x00,
    0xf3, 0x13, 0x00, 0x00, 0x13, 0xf2, 0x00,
    0xd3, 0x31, 0x00, 0x00, 0x2e, 0xd2, 0x00,
    0x94, 0x7c, 0x00, 0x00, 0x73, 0x93, 0x00,
    0x28, 0xe5, 0x2f, 0x24, 0xde, 0x29, 0x00,
    0x00, 0x54, 0xe5, 0xe8, 0x5a, 0x00, 0x00,

    // Glyph for character {0x31}
    0x00, 0x18, 0xb5, 0x00, 0x00, 0x00, 0x00,
    0xc0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x15, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x2f, 0xff, 0x3e, 0x01, 0x00, 0x00,
    0xc0, 0xff, 0xff, 0xff, 0xd0, 0x00, 0x00,

    // Glyph for character {0x32}
    0x0e, 0x98, 0xea, 0xed, 0xad, 0x19, 0x00,
    0x88, 0x34, 0x07, 0x24, 0xb6, 0xb3, 0x00,
    0xaf, 0x00, 0x00, 0x00, 0x1f, 0xf3, 0x00,
    0x6e, 0x00, 0x00, 0x00, 0x0e, 0xdc, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x5c, 0x72, 0x00,
    0x00, 0x00, 0x00, 0x15, 0x8b, 0x02, 0x00,
    0x00, 0x00, 0x10, 0x71, 0x03, 0x00, 0x00,
    0x00, 0x11, 0x6f, 0x02, 0x00, 0x00, 0x00,
    0x0a, 0x76, 0x03, 0x00, 0x00, 0x55, 0x00,
    0x77, 0x0a, 0x00, 0x00, 0x19, 0xac, 0x00,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xb4, 0x00,

    // Glyph for character {0x33}
    0x20, 0xae, 0xef, 0xe8, 0x97, 0x0c, 0x00,
    0xaf, 0x2b, 0x09, 0x29, 0xbd, 0xa2, 0x00,
    0xc6, 0x00, 0x00, 0x00, 0x1c, 0xf2, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x20, 0xcb, 0x00,
    0x00, 0x00, 0x0c, 0x38, 0xa6, 0x31, 0x00,
    0x00, 0x00, 0xff, 0xed, 0x4a, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x2a, 0xb4, 0x62, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x18, 0xe1, 0x00,
    0xbe, 0x00, 0x00, 0x00, 0x1b, 0xea, 0x00,
    0xb5, 0x29, 0x08, 0x27, 0xb2, 0x8d, 0x00,
    0x26, 0xba, 0xf4, 0xe0, 0x85, 0x06, 0x00,

    // Glyph for character {0x34}
    0x00, 0x00, 0x00, 0x0c, 0xe3, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x91, 0xff, 0x00, 0x00,
    0x00, 0x00, 0x33, 0xdc, 0xff, 0x00, 0x00,
    0x00, 0x03, 0xc7, 0x35, 0xff, 0x00, 0x00,
    0x00, 0x71, 0x6f, 0x00, 0xff, 0x00, 0x00,
    0x1c, 0xa2, 0x00, 0x00, 0xff, 0x00, 0x00,
    0x8f, 0x10, 0x00, 0x00, 0xff, 0x00, 0x00,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xb0,
    0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x1a, 0xff, 0x21, 0x00,
    0x00, 0x00, 0xa0, 0xff, 0xff, 0xff, 0x80,

    // Glyph for character {0x35}
    0xb0, 0xff, 0xff, 0xff, 0xff, 0xe5, 0x00,
    0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x7d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x7e, 0x8b, 0xe3, 0xeb, 0x94, 0x08, 0x00,
    0xca, 0x56, 0x13, 0x1c, 0xb7, 0x87, 0x00,
    0x04, 0x00, 0x00, 0x00, 0x26, 0xe0, 0x00,
    0x15, 0x00, 0x00, 0x00, 0x09, 0xf6, 0x00,
    0xd3, 0x00, 0x00, 0x00, 0x34, 0xd7, 0x00,
    0x95, 0x2e, 0x0a, 0x2a, 0xc9, 0x77, 0x00,
    0x1b, 0xac, 0xf1, 0xe2, 0x89, 0x04, 0x00,

    // Glyph for character {0x36}
    0x00, 0x3c, 0xd3, 0xf3, 0x74, 0x00, 0x00,
    0x18, 0xd9, 0x40, 0x0d, 0xe8, 0x00, 0x00,
    0x81, 0x65, 0x00, 0x00, 0x19, 0x00, 0x00,
    0xc6, 0x27, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xec, 0x31, 0xc8, 0xf7, 0xb9, 0x14, 0x00,
    0xfb, 0x9f, 0x2a, 0x11, 0xaa, 0x96, 0x00,
    0xfa, 0x23, 0x00, 0x00, 0x1e, 0xe5, 0x00,
    0xe4, 0x17, 0x00, 0x00, 0x07, 0xf5, 0x00,
    0xb0, 0x58, 0x00, 0x00, 0x25, 0xd7, 0x00,
    0x49, 0xe1, 0x34, 0x11, 0xa4, 0x7a, 0x00,
    0x00, 0x6d, 0xe5, 0xed, 0x91, 0x06, 0x00,

    // Glyph for character {0x37}
    0xa5, 0xff, 0xff, 0xff, 0xff, 0xe8, 0x00,
    0xae, 0x26, 0x00, 0x00, 0x23, 0x5b, 0x00,
    0x58, 0x00, 0x00, 0x00, 0x68, 0x01, 0x00,
    0x00, 0x00, 0x00, 0x1c, 0x4a, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x64, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x09, 0x6d, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x58, 0x31, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x9f, 0x09, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xce, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xf5, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xd0, 0x00, 0x00, 0x00, 0x00,

    // Glyph for character {0x38}
    0x13, 0xa1, 0xea, 0xed, 0xa4, 0x13, 0x00,
    0xae, 0x9d, 0x16, 0x13, 0xa2, 0xae, 0x00,
    0xf3, 0x10, 0x00, 0x00, 0x15, 0xf3, 0x00,
    0xc9, 0x56, 0x00, 0x00, 0x1b, 0xc7, 0x00,
    0x2c, 0xdd, 0x8a, 0x28, 0x92, 0x29, 0x00,
    0x00, 0x7e, 0x95, 0xef, 0x84, 0x00, 0x00,
    0x73, 0x6c, 0x00, 0x18, 0xca, 0x70, 0x00,
    0xe1, 0x10, 0x00, 0x00, 0x27, 0xe2, 0x00,
    0xf1, 0x19, 0x00, 0x00, 0x13, 0xef, 0x00,
    0x9d, 0xaf, 0x1a, 0x12, 0x9b, 0x9f, 0x00,
    0x0a, 0x92, 0xe9, 0xeb, 0x9b, 0x0d, 0x00,

    // Glyph for character {0x39}
    0x06, 0x9b, 0xf3, 0xe8, 0x70, 0x00, 0x00,
    0x7a, 0xb7, 0x19, 0x1d, 0xc0, 0x4b, 0x00,
    0xd9, 0x2b, 0x00, 0x00, 0x36, 0xb3, 0x00,
    0xf7, 0x07, 0x00, 0x00, 0x0a, 0xe6, 0x00,
    0xe6, 0x22, 0x00, 0x00, 0x35, 0xfa, 0x00,
    0xa4, 0xab, 0x12, 0x32, 0xa1, 0xf1, 0x00,
    0x1a, 0xb7, 0xf3, 0xc5, 0x3f, 0xda, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x49, 0xb5, 0x00,
    0x00, 0x16, 0x00, 0x00, 0x95, 0x62, 0x00,
    0x00, 0xeb, 0x0f, 0x4b, 0xe3, 0x0f, 0x00,
    0x00, 0x84, 0xf4, 0xd4, 0x38, 0x00, 0x00,

    // Glyph for character {0x3a}
    0xc5, 0xc4, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xc7, 0xc5, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xc5, 0xc4, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xc7, 0xc5, 0x00, 0x00, 0x00, 0x00, 0x00,
    // a white space
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
};

ARM_SECTION("arm2d.asset.FONT")
 const __ttf_char_descriptor_t c_tUTF8simsun_16LookUpTableA8[] = {

    { 0, { 6, 1, }, 8, 1, 6, 1, {0x2d} },
    { 1, { 6, 11, }, 8, 1, 11, 1, {0x30} },
    { 12, { 5, 11, }, 8, 2, 11, 1, {0x31} },
    { 23, { 6, 11, }, 8, 1, 11, 1, {0x32} },
    { 34, { 6, 11, }, 8, 1, 11, 1, {0x33} },
    { 45, { 7, 11, }, 8, 1, 11, 1, {0x34} },
    { 56, { 6, 11, }, 8, 1, 11, 1, {0x35} },
    { 67, { 6, 11, }, 8, 1, 11, 1, {0x36} },
    { 78, { 6, 11, }, 8, 1, 11, 1, {0x37} },
    { 89, { 6, 11, }, 8, 1, 11, 1, {0x38} },
    { 100, { 6, 11, }, 8, 1, 11, 1, {0x39} },
    { 111, { 2, 8, }, 8, 3, 8, 1, {0x3a} },
    { 119, { 7, 11, }, 7, 0, 11, 1, {0x20} },
};



ARM_SECTION("arm2d.tile.c_tileUTF8simsun_16A8Mask")
static const arm_2d_tile_t c_tileUTF8simsun_16A8Mask = {
    .tRegion = {
        .tSize = {
            .iWidth = 7,
            .iHeight = 132,
        },
    },
    .tInfo = {
        .bIsRoot = true,
        .bHasEnforcedColour = true,
        .tColourInfo = {
            .chScheme = ARM_2D_COLOUR_8BIT,
        },
    },
    .pchBuffer = (uint8_t *)c_bmpUTF8simsun_16A8Font,
};

#define __UTF8_FONT_SIZE_8__



static
IMPL_FONT_GET_CHAR_DESCRIPTOR(__utf8_a8_font_get_char_descriptor)
{
    assert(NULL != ptFont);
    assert(NULL != ptDescriptor);
    assert(NULL != pchCharCode);

    arm_2d_user_font_t *ptThis = (arm_2d_user_font_t *)ptFont;
    ARM_2D_UNUSED(ptThis);

    memset(ptDescriptor, 0, sizeof(arm_2d_char_descriptor_t));

    ptDescriptor->tileChar.ptParent = (arm_2d_tile_t *)&ptFont->tileFont;
    ptDescriptor->tileChar.tInfo.bDerivedResource = true;

    /* use the white space as the default char */
    __ttf_char_descriptor_t *ptUTF8Char =
        (__ttf_char_descriptor_t *)&c_tUTF8simsun_16LookUpTableA8[dimof(c_tUTF8simsun_16LookUpTableA8)-1];

    arm_foreach(__ttf_char_descriptor_t, c_tUTF8simsun_16LookUpTableA8, ptChar) {
        if (0 == strncmp(   (char *)pchCharCode,
                            (char *)ptChar->chUTF8,
                            ptChar->chCodeLength)) {
            /* found the UTF8 char */
            ptUTF8Char = ptChar;
            break;
        }
    }

    ptDescriptor->chCodeLength = ptUTF8Char->chCodeLength;
    ptDescriptor->tileChar.tRegion.tSize = ptUTF8Char->tCharSize;
    ptDescriptor->tileChar.tRegion.tLocation.iY = (int16_t)ptUTF8Char->hwIndex;

    ptDescriptor->iAdvance = ptUTF8Char->iAdvance;
    ptDescriptor->iBearingX= ptUTF8Char->iBearingX;
    ptDescriptor->iBearingY= ptUTF8Char->iBearingY;

    return ptDescriptor;
}

const
struct {
    implement(arm_2d_user_font_t);
    arm_2d_char_idx_t tUTF8Table;
} ARM_2D_FONT_simsun_16_A8 = {

    .use_as__arm_2d_user_font_t = {
        .use_as__arm_2d_font_t = {
            .tileFont = impl_child_tile(
                c_tileUTF8simsun_16A8Mask,
                0,          /* x offset */
                0,          /* y offset */
                7,        /* width */
                132         /* height */
            ),
            .tCharSize = {
                .iWidth = 7,
                .iHeight = 11,
            },
            .nCount =  12,                             //!< Character count
            .fnGetCharDescriptor = &__utf8_a8_font_get_char_descriptor,
            .fnDrawChar = &__arm_2d_lcd_text_default_a8_font_draw_char,
        },
        .hwCount = 1,
        .hwDefaultCharIndex = 1, /* tBlank */
    },

    .tUTF8Table = {
        .hwCount = 12,
        .hwOffset = 0,
    },
};

#undef __UTF8_FONT_SIZE_8__



#if defined(__clang__)
#   pragma clang diagnostic pop
#elif defined(__IS_COMPILER_ARM_COMPILER_5__)
#   pragma diag_warning=1296
#endif

